# 実装進捗ドキュメント

最終更新: 2026-01-29

このドキュメントは `docs/SPEC.md` に記載されている機能の実装状況を追跡します。

---

## 凡例

- ✅ **完了**: 実装済み、テスト可能
- 🟡 **部分実装**: 基本機能は動作するが一部機能が未実装
- 🔴 **未実装**: まだ実装されていない
- ⏸️ **MVP除外**: MVPスコープ外

---

## 1. 非機能仕様 (SPEC Section 1)

| 機能 | 状態 | 備考 |
|------|------|------|
| JST タイムゾーン対応 | ✅ 完了 | 日付表示、リセット処理 |
| 成功時のみ消費 | ✅ 完了 | クレジット、無料回数とも実装済み |
| 非同期UX | 🟡 部分実装 | トースト・通知機能は実装済み、処理中表示も実装済み |

---

## 2. 認証・アカウント (SPEC Section 2)

| 機能 | 状態 | 備考 |
|------|------|------|
| ゲスト利用 | ✅ 完了 | `guestUsers` テーブル、7日保持 |
| Google ログイン | ✅ 完了 | Better Auth + Google OAuth |
| ゲスト→ログイン移行 | ✅ 完了 | データ引き継ぎ実装済み |
| プラン選択画面 | ✅ 完了 | `/plan-selection` |
| ゲスト制限（企業3社、クレジット15等） | ✅ 完了 | スキーマ・API実装済み |
| ログイン促し（機能ごと1回） | ✅ 完了 | `loginPrompts` テーブル |
| アカウント削除 | ✅ 完了 | API + 設定画面の削除モーダル実装済み |

---

## 3. 料金・プラン・制限 (SPEC Section 3)

| 機能 | 状態 | 備考 |
|------|------|------|
| Free/Standard/Pro プラン | ✅ 完了 | `userProfiles.plan` |
| Stripe 連携 | ✅ 完了 | Webhook、Checkout 実装済み |
| 企業登録上限 | ✅ 完了 | Free: 5社、Guest: 3社 |
| プラン変更即時反映 | 🟡 部分実装 | Webhook処理済み、UI未実装 |
| 支払い失敗時ダウングレード | ✅ 完了 | Webhook で処理 |
| 企業RAG取得ページ上限 | 🔴 未実装 | RAG機能自体が部分実装 |

---

## 4. クレジット仕様 (SPEC Section 4)

| 機能 | 状態 | 備考 |
|------|------|------|
| 月次付与 | ✅ 完了 | Free: 30, Standard: 300, Pro: 800 |
| 企業情報取得/更新の無料回数 | ✅ 完了 | 3回/日、ゲスト2回/日 |
| ES添削クレジット消費 | ✅ 完了 | `ceil(文字数/800)`、上限5 |
| 部分成功（0.5クレジット） | ✅ 完了 | 締切抽出失敗時の部分消費（0.5累積方式）|
| 実行履歴の通知 | ✅ 完了 | `notifications` テーブル |
| クレジット不足時の実行不可 | ✅ 完了 | API でチェック |

---

## 5. 画面一覧 (SPEC Section 5)

| 画面 | 状態 | パス |
|------|------|------|
| オンボーディング | ✅ 完了 | `/onboarding` |
| ダッシュボード | ✅ 完了 | `/dashboard` |
| 企業一覧 | ✅ 完了 | `/companies` |
| 企業詳細 | ✅ 完了 | `/companies/[id]` |
| 企業登録 | ✅ 完了 | `/companies/new` |
| カレンダー | ✅ 完了 | `/calendar` |
| カレンダー設定 | ✅ 完了 | `/calendar/settings` |
| 締切/タスク一覧 | ✅ 完了 | `/tasks` |
| ESエディタ | ✅ 完了 | `/es/[id]` |
| ES一覧 | ✅ 完了 | `/es` |
| ESテンプレ管理 | ✅ 完了 | `/templates` |
| 公開ギャラリー | ✅ 完了 | `/templates/gallery` |
| 通知一覧 | ✅ 完了 | `/notifications` |
| 設定 | ✅ 完了 | `/settings` |
| ガクチカ一覧 | ✅ 完了 | `/gakuchika` |
| ガクチカ詳細 | ✅ 完了 | `/gakuchika/[id]` |

---

## 6. オンボーディング (SPEC Section 6)

| 機能 | 状態 | 備考 |
|------|------|------|
| 大学・学部入力 | ✅ 完了 | Step 1 |
| 志望業界・職種選択 | ✅ 完了 | Step 2 |
| スキップ機能 | ✅ 完了 | いつでもスキップ可能 |
| ダッシュボードへの遷移 | ✅ 完了 | 完了後遷移 |
| ガクチカ素材入力 | 🔴 未実装 | オンボーディング内では未実装（別画面で対応） |

---

## 7. ダッシュボード (SPEC Section 7)

| 機能 | 状態 | 備考 |
|------|------|------|
| 今日の最重要1タスク | ✅ 完了 | API: `/api/tasks/today` |
| 通知欄 | ✅ 完了 | 最大5件 + 「他◯件」 |
| クレジット残高表示 | ✅ 完了 | 残量・次回付与日 |
| 締切警告（3日/24時間以内） | ✅ 完了 | DeadlineList コンポーネント |
| タスク開始→画面遷移 | ✅ 完了 | |

---

## 8. 企業登録 (SPEC Section 8)

| 機能 | 状態 | 備考 |
|------|------|------|
| 企業名・業界入力 | ✅ 完了 | `/companies/new` |
| Free/ゲスト上限チェック | ✅ 完了 | API でバリデーション |
| 重複判定 | 🟡 部分実装 | 名前完全一致のみ、法人判定は未実装 |
| 削除時の紐づきデータ削除 | ✅ 完了 | CASCADE 設定済み |
| 並び替え・ピン留め | ✅ 完了 | `isPinned`, `sortOrder` 実装済み |

---

## 9. 企業情報取得/更新 (SPEC Section 9)

| 機能 | 状態 | 備考 |
|------|------|------|
| 採用ページ候補3件提示 | 🔴 未実装 | 現在は手動URL入力のみ |
| 手動URL入力 | ✅ 完了 | `FetchInfoButton` |
| 情報抽出（締切/募集区分等） | 🟡 部分実装 | FastAPI `company_info.py` 基本実装済み |
| 根拠URL・信頼度表示 | 🟡 部分実装 | スキーマにフィールドあり、UI表示は部分的 |
| 締切候補の承認モーダル | ✅ 完了 | `DeadlineApprovalModal` |
| 更新時の差分提示 | 🔴 未実装 | |

---

## 10. 応募枠 (SPEC Section 10)

| 機能 | 状態 | 備考 |
|------|------|------|
| 応募枠CRUD | ✅ 完了 | `applications` テーブル |
| フェーズ管理 | ✅ 完了 | 5種のフェーズテンプレート実装済み |
| 職種管理 | ✅ 完了 | `jobTypes` テーブル |
| 応募枠上限（10枠/企業） | ✅ 完了 | APIでバリデーション済み |
| フェーズテンプレ | ✅ 完了 | インターン（夏/秋/冬）/早期選考/本選考 |

---

## 11. 締切承認UX (SPEC Section 11)

| 機能 | 状態 | 備考 |
|------|------|------|
| 承認モーダル | ✅ 完了 | `DeadlineApprovalModal` |
| LOW信頼度の初期OFF | ✅ 完了 | |
| 0件承認エラー | ✅ 完了 | |
| 終日締切（12:00扱い） | 🔴 未実装 | |
| 締切変更検知 | 🔴 未実装 | |
| 提出済み連動（タスク一括完了） | ✅ 完了 | completedAt 設定時に自動処理 |
| 手動締切追加/編集 | ✅ 完了 | `DeadlineModal` |

---

## 12. 通知 (SPEC Section 12)

| 機能 | 状態 | 備考 |
|------|------|------|
| 締切リマインド | ✅ 完了 | Vercel Cron でバッチ処理 |
| 企業更新/ES添削結果通知 | ✅ 完了 | |
| 通知一覧表示 | ✅ 完了 | `/notifications` |
| 未読/既読管理 | ✅ 完了 | |
| すべて既読ボタン | ✅ 完了 | |
| 通知タイプ別ON/OFF | ✅ 完了 | 設定画面に実装済み |
| 90日自動削除 | ✅ 完了 | Vercel Cron でバッチ処理 |
| 日次通知（JST 9:00） | ✅ 完了 | Vercel Cron `0 0 * * *` |

---

## 13. タスク・進捗管理 (SPEC Section 13)

| 機能 | 状態 | 備考 |
|------|------|------|
| タスクCRUD | ✅ 完了 | `/api/tasks` |
| 任意タスク追加 | ✅ 完了 | |
| 企業/応募枠紐づけ | ✅ 完了 | |
| 今日の最重要1タスク推薦 | ✅ 完了 | DEADLINE/DEEP_DIVEモード |
| 締切承認時の標準タスク自動作成 | ✅ 完了 | ES作成/提出物準備/提出の3タスク |
| タスク種別管理 | 🟡 部分実装 | 固定enum、ユーザー追加未実装 |
| タスク一覧の並び順（締切順） | ✅ 完了 | |

---

## 14. カレンダー連携 (SPEC Section 14)

| 機能 | 状態 | 備考 |
|------|------|------|
| アプリ内カレンダー | ✅ 完了 | `/calendar` |
| Google カレンダー連携 | 🟡 部分実装 | スキーマあり、OAuth実装必要 |
| 追加先カレンダー選択 | 🟡 部分実装 | 設定画面あり、Google連携は未完 |
| freebusy（空き時間算出） | 🔴 未実装 | |
| 作業ブロック追加 | ✅ 完了 | |
| [ウカルン]接頭辞 | ✅ 完了 | カレンダーイベント作成時に付与 |
| 置換モード | 🔴 未実装 | |
| 作業ブロック自動提案 | 🔴 未実装 | |

---

## 15. ESエディタ (SPEC Section 15)

| 機能 | 状態 | 備考 |
|------|------|------|
| 左右分割（本文/AI添削） | ✅ 完了 | |
| Notion風ブロックエディタ | ✅ 完了 | H2/段落/箇条書き |
| 文字数カウント（設問単位） | ✅ 完了 | 文字数制限表示も実装 |
| 自動保存 | ✅ 完了 | 2秒デバウンス |
| 編集履歴（5版） | 🟡 部分実装 | スキーマあり、UI未実装 |
| ゴミ箱（30日） | 🟡 部分実装 | スキーマあり、復元UI未実装 |
| ES/Tips/企業分析の種別 | ✅ 完了 | |
| 応募枠・職種紐づけ | ✅ 完了 | |

---

## 16. AI添削 (SPEC Section 16)

| 機能 | 状態 | 備考 |
|------|------|------|
| スコア（5軸）表示 | ✅ 完了 | 論理/具体性/熱意/企業接続/読みやすさ |
| 改善優先順位Top3 | ✅ 完了 | |
| リライト（Free: 1本、有料: 3本） | ✅ 完了 | |
| スタイル選択 | ✅ 完了 | 8種（有料は全種） |
| 設問別指摘（有料） | ✅ 完了 | 文字数制限も考慮 |
| 企業接続評価（RAG時のみ） | ✅ 完了 | |
| 全文添削（コピーのみ） | ✅ 完了 | |
| セクション/ブロック反映 | 🟡 部分実装 | クリップボードコピーのみ、直接反映は未実装 |
| 反映確認モーダル + Undo | 🔴 未実装 | |
| AIスレッド管理 | 🟡 部分実装 | スキーマあり、UI未実装 |
| 添削履歴保存（Free: 20件等） | 🟡 部分実装 | 保存済み、上限管理未実装 |

### ESテンプレ (SPEC Section 16.9)

| 機能 | 状態 | 備考 |
|------|------|------|
| 初期テンプレ5種 | ✅ 完了 | インターン①②③/早期選考/本選考 |
| テンプレ作成上限 | ✅ 完了 | Free: 5, Standard: 20, Pro: 無制限 |
| テンプレ共有リンク | 🟡 部分実装 | スキーマあり、有効期限30日未実装 |
| 公開ギャラリー | ✅ 完了 | `/templates/gallery` |
| いいね/お気に入り | ✅ 完了 | |
| ランキング（週/月/年） | ✅ 完了 | ギャラリー内でソート可能 |
| 検索・フィルタ | ✅ 完了 | |

---

## 17. ガクチカ深掘りBot (SPEC Section 17)

| 機能 | 状態 | 備考 |
|------|------|------|
| 深掘り対話 | ✅ 完了 | FastAPI `gakuchika.py` |
| 目安8問 | ✅ 完了 | |
| 中断/再開 | ✅ 完了 | |
| クレジット消費（5問ごと1） | ✅ 完了 | |
| Q&A保存 | ✅ 完了 | `gakuchikaConversations` |
| 素材の企業紐づけ | 🟡 部分実装 | スキーマあり、UI未実装 |
| サマリー生成 | ✅ 完了 | `/summary` エンドポイント |

---

## 18. 提出物テンプレ (SPEC Section 18)

| 機能 | 状態 | 備考 |
|------|------|------|
| 提出物項目（履歴書/ES/証明写真等） | ✅ 完了 | `submissionItems` テーブル |
| 応募枠ごとの提出物管理 | ✅ 完了 | `SubmissionsList` コンポーネント |
| 標準項目（履歴書/ES削除不可） | ✅ 完了 | API & UI で削除保護実装 |

---

## バックエンド (FastAPI)

| 機能 | 状態 | ファイル |
|------|------|------|
| ES添削 | ✅ 完了 | `backend/app/routers/es_review.py` |
| ガクチカ深掘り | ✅ 完了 | `backend/app/routers/gakuchika.py` |
| 企業情報抽出 | 🟡 部分実装 | `backend/app/routers/company_info.py` |
| LLMユーティリティ | ✅ 完了 | `backend/app/utils/llm.py` |
| ベクトルストア（RAG） | 🟡 部分実装 | `backend/app/utils/vector_store.py` |

---

## E2Eテスト

| テスト | 状態 | ファイル |
|------|------|------|
| 認証 | ✅ 作成済み | `e2e/auth.spec.ts` |
| 企業管理 | ✅ 作成済み | `e2e/companies.spec.ts` |
| ESエディタ | ✅ 作成済み | `e2e/es-editor.spec.ts` |
| タスク管理 | ✅ 作成済み | `e2e/tasks.spec.ts` |

---

## 実装優先度（推奨）

### 高優先度（コア体験に直結）
1. ✅ 締切承認時の標準タスク自動作成 → **実装完了**
2. ✅ 初期ESテンプレ5種の作成 → **実装完了**
3. ✅ 日次通知バッチ処理 → **実装完了**
4. ✅ 部分クレジット消費（0.5） → **実装完了**
5. ✅ 提出物（履歴書/ES）削除保護 → **実装完了**

### 中優先度
6. 🔴 採用ページ候補3件提示（企業情報取得のUX改善）
7. 🟡 Google カレンダーOAuth完全実装
8. 🔴 作業ブロック自動提案
9. 🔴 終日締切（12:00扱い）

### 低優先度（MVP後）
10. 🔴 企業名の法人判定
11. 🔴 置換モード（カレンダー）
12. 🔴 freebusy（空き時間算出）

---

## 統計サマリー

| カテゴリ | 完了 | 部分実装 | 未実装 |
|----------|------|----------|--------|
| 認証・アカウント | 7 | 0 | 0 |
| 料金・クレジット | 9 | 1 | 1 |
| 画面 | 16 | 0 | 0 |
| 企業管理 | 10 | 2 | 3 |
| 通知 | 8 | 0 | 0 |
| タスク | 6 | 1 | 0 |
| カレンダー | 3 | 2 | 3 |
| ESエディタ | 7 | 2 | 1 |
| AI添削 | 12 | 3 | 0 |
| ガクチカ | 6 | 1 | 0 |
| 提出物 | 3 | 0 | 0 |
| **合計** | **87** | **12** | **8** |

**実装完了率: 約 81%**（部分実装を50%として計算すると約 87%）

---

## 最近の更新履歴

### 2026-01-29
- ✅ 提出物（履歴書/ES）の削除保護を実装（API & UI両方）
- ✅ 部分クレジット消費（0.5）を実装（締切抽出失敗時の累積方式）
- ✅ IMPLEMENTATION_STATUS.md を実際の実装状況に合わせて大幅更新
  - テンプレート作成制限：既に実装済み
  - 応募枠上限・フェーズテンプレート：既に実装済み
  - 企業ソート/ピン留め：既に実装済み
  - 通知設定UI：既に実装済み
  - ギャラリーランキング：既に実装済み
  - カレンダー接頭辞[ウカルン]：既に実装済み
- ✅ 実装完了率を73%→81%に更新

### 2026-01-28
- ✅ 締切承認時の標準タスク自動作成を実装
- ✅ 初期ESテンプレ5種をSPEC.md準拠に更新（インターン①②③/早期選考/本選考）
- ✅ 日次通知バッチ処理を実装（Vercel Cron JST 9:00）
- ✅ アカウント削除機能が既に実装済みであることを確認
- ✅ 提出済み連動（タスク一括完了）が既に実装済みであることを確認
